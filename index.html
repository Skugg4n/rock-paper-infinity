<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sax, Sten, Påse - Upplåsning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style id="dynamic-styles"></style> <!-- För dynamiska animationstider -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="text-slate-800">

    <!-- Star display on the left -->
    <div class="absolute top-8 left-4 md:left-8">
        <div id="win-tracker" class="flex flex-col items-start gap-3"></div>
    </div>

    <!-- Resource bars on the right -->
    <div id="resource-bars" class="hidden absolute top-8 right-4 md:right-8 flex flex-col items-end gap-4">
        <div class="flex items-end gap-2">
            <div id="energy-container" class="w-4 h-32 bg-slate-300 rounded-full overflow-hidden p-1 flex flex-col justify-end">
                <div id="energy-fill" class="w-full bg-emerald-500 rounded-full transition-all duration-300"></div>
            </div>
            <div id="reserve-energy-container" class="w-6 h-40 bg-slate-300 rounded-full overflow-hidden p-1 flex flex-col justify-end">
                <div id="reserve-energy-fill" class="w-full bg-sky-500 rounded-full transition-all duration-300"></div>
            </div>
        </div>
        <div id="quantum-foam-container" class="hidden w-16 flex flex-col items-center gap-2">
            <button id="collapse-foam-btn" class="btn w-12 h-12 rounded-full flex justify-center items-center overflow-hidden" disabled>
                <div id="collapse-foam-fill" style="height: 0%;"></div>
                <i data-lucide="zap" class="relative w-6 h-6 text-slate-600"></i>
            </button>
        </div>
        <div id="sps-container" class="hidden flex items-center gap-2 text-slate-500">
            <span id="sps-value" class="font-bold text-lg font-mono">0.0</span>
            <div class="flex items-center">
                <i data-lucide="star" class="w-4 h-4"></i>
                <span class="font-bold text-sm mx-0.5">/</span>
                <i data-lucide="timer" class="w-4 h-4"></i>
            </div>
        </div>
        <div id="eps-container" class="hidden flex items-center gap-2 text-slate-500">
            <span id="eps-value" class="font-bold text-lg font-mono">0.0</span>
            <div class="flex items-center">
                <i data-lucide="zap-off" class="w-4 h-4"></i>
                <span class="font-bold text-sm mx-0.5">/</span>
                <i data-lucide="timer" class="w-4 h-4"></i>
            </div>
        </div>
         <div id="egps-container" class="hidden flex items-center gap-2 text-slate-500">
            <span id="egps-value" class="font-bold text-lg font-mono">0.0</span>
            <div class="flex items-center">
                <i data-lucide="atom" class="w-4 h-4"></i>
                <span class="font-bold text-sm mx-0.5">/</span>
                <i data-lucide="timer" class="w-4 h-4"></i>
            </div>
        </div>
    </div>

    <!-- Huvudcontainer för spelet -->
    <div class="w-full max-w-2xl mx-auto p-4 flex flex-col h-[100svh]">
        <header class="h-16 flex-shrink-0"></header> <!-- Spacer -->
        
        <main id="game-board-container" class="pointer-events-none flex-grow grid grid-cols-1 items-center justify-center gap-4">
            <!-- Spelbord kommer att injiceras här av JS -->
        </main>

        <footer id="player-zone" class="h-40 flex-shrink-0 flex flex-col justify-end items-center gap-4 pb-4">
            <div id="player-controls-container" class="grid grid-cols-5 gap-2 w-full max-w-sm">
                <button data-choice="rock" class="btn choice-btn bg-slate-50 w-16 h-16 rounded-full shadow-md flex justify-center items-center"><i data-lucide="gem"></i></button>
                <button data-choice="paper" class="btn choice-btn bg-slate-50 w-16 h-16 rounded-full shadow-md flex justify-center items-center"><i data-lucide="file-text"></i></button>
                <button data-choice="scissors" class="btn choice-btn bg-slate-50 w-16 h-16 rounded-full shadow-md flex justify-center items-center"><i data-lucide="scissors"></i></button>
                <button id="manualRecharge" data-upgrade="manualRecharge" class="invisible btn upgrade-btn bg-slate-50 w-16 h-16 rounded-full shadow-md flex justify-center items-center"><i data-lucide="battery-charging"></i></button>
                <button id="autoPlay" data-upgrade="autoPlay" class="invisible btn upgrade-btn bg-slate-50 w-16 h-16 rounded-full shadow-md flex justify-center items-center"><i data-lucide="repeat-2"></i></button>
            </div>
              <div id="version-info" class="text-[10px] text-slate-400 select-none self-start">v1.3.8</div>
        </footer>
    </div>

    <!-- Uppgraderingsknappar -->
    <div class="absolute bottom-8 right-8 flex items-end gap-3">
        <div id="downgrade-tray" class="flex flex-col gap-3"></div>
        <div id="upgrade-tray" class="flex flex-col gap-3">
            <button id="speed" data-upgrade="speed" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg">
                <svg class="absolute inset-0 w-full h-full" viewBox="0 0 36 36">
                    <circle class="progress-ring-bg" cx="18" cy="18" r="16" fill="none" stroke-width="3"></circle>
                    <circle id="speed-early-progress" class="progress-ring-pre" cx="18" cy="18" r="16" fill="none" stroke-width="3" stroke-dasharray="100.5" stroke-dashoffset="100.5"></circle>
                    <circle id="speed-progress" class="progress-ring-fg" cx="18" cy="18" r="16" fill="none" stroke-width="3" stroke-dasharray="100.5" stroke-dashoffset="100.5"></circle>
                </svg>
                <i id="speed-icon" data-lucide="chevrons-right" class="relative w-6 h-6 text-slate-600"></i>
            </button>
            <button id="energyGenerator" data-upgrade="energyGenerator" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg">
                <svg class="absolute inset-0 w-full h-full" viewBox="0 0 36 36">
                    <circle class="progress-ring-bg" cx="18" cy="18" r="16" fill="none" stroke-width="3"></circle>
                    <circle id="energy-gen-progress" class="progress-ring-fg" cx="18" cy="18" r="16" fill="none" stroke-width="3" stroke-dasharray="100.5" stroke-dashoffset="100.5"></circle>
                </svg>
                <i data-lucide="atom" class="relative w-6 h-6 text-slate-600"></i>
            </button>
            <button id="buyBattery" data-upgrade="buyBattery" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg"><i data-lucide="battery-plus" class="relative w-6 h-6 text-slate-600"></i></button>
            <button id="luck" data-upgrade="luck" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg"><i data-lucide="clover" class="relative w-6 h-6 text-slate-600"></i></button>
            <button id="addGameBoard" data-upgrade="addGameBoard" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg">
                <svg class="absolute inset-0 w-full h-full" viewBox="0 0 36 36">
                    <circle class="progress-ring-bg" cx="18" cy="18" r="16" fill="none" stroke-width="3"></circle>
                    <circle id="add-board-progress" class="progress-ring-fg" cx="18" cy="18" r="16" fill="none" stroke-width="3" stroke-dasharray="100.5" stroke-dashoffset="100.5"></circle>
                </svg>
                <i data-lucide="copy" class="relative w-6 h-6 text-slate-600"></i>
            </button>
            <button id="mergeGameBoard" data-upgrade="mergeGameBoard" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg"><i data-lucide="factory" class="relative w-6 h-6 text-slate-600"></i></button>
            <button id="bank" data-upgrade="bank" class="invisible btn upgrade-btn bg-white p-3 rounded-full shadow-lg"><i data-lucide="wallet" class="relative w-6 h-6 text-slate-600"></i></button>
        </div>
    </div>

    <!-- Menu button -->
    <div id="menu-wrapper" class="fixed bottom-4 left-4">
        <div class="relative">
            <button id="menu-btn" class="btn w-12 h-12 rounded-full bg-white shadow-lg transition-transform hover:scale-110">
                <i data-lucide="menu" class="w-6 h-6 text-slate-600"></i>
            </button>
            <div id="menu-dropdown" class="hidden absolute bottom-14 left-0 bg-white rounded-lg shadow-lg">
                <button id="reset-btn" class="block px-4 py-2 text-sm hover:bg-slate-100 whitespace-nowrap">Reset everything</button>
            </div>
        </div>
    </div>

    <!-- Debug-meny -->
    <div id="debug-trigger" class="absolute top-0 left-0 w-16 h-16 cursor-pointer"></div>
        <div id="debug-menu" class="hidden absolute top-16 left-4 flex flex-col gap-2 bg-slate-700 p-2 rounded-lg shadow-xl z-20">
        <div class="text-white text-xs font-bold border-b border-slate-600 pb-1 mb-1">Stjärnor</div>
        <button data-add-stars="1" class="text-white text-xs font-bold bg-slate-600 hover:bg-slate-500 rounded px-2 py-1">+1 ★</button>
        <button data-add-stars="100" class="text-white text-xs font-bold bg-slate-600 hover:bg-slate-500 rounded px-2 py-1">+100 ★</button>
        <button data-add-stars="1000" class="text-white text-xs font-bold bg-slate-600 hover:bg-slate-500 rounded px-2 py-1">+1k ★</button>
        <button data-add-stars="10000" class="text-white text-xs font-bold bg-slate-600 hover:bg-slate-500 rounded px-2 py-1">+10k ★</button>
        <div class="text-white text-xs font-bold border-b border-slate-600 pb-1 my-1">Hastighet</div>
        <div class="flex items-center justify-between gap-2">
             <button data-change-speed="-1" class="text-white text-lg font-bold bg-slate-600 hover:bg-slate-500 rounded w-6 h-6">-</button>
             <span id="debug-speed" class="text-white text-xs font-mono">⚡︎ 1x</span>
             <button data-change-speed="1" class="text-white text-lg font-bold bg-slate-600 hover:bg-slate-500 rounded w-6 h-6">+</button>
        </div>
        <div class="text-white text-xs font-bold border-b border-slate-600 pb-1 my-1">Spel</div>
          <div id="debug-games-played" class="text-white text-xs font-mono text-center">0</div>
          <button class="text-white text-xs font-bold bg-slate-600 hover:bg-slate-500 rounded px-2 py-1" onclick="window.location.href='stage-2.html'">Go to Stage 2</button>
      </div>
    
    <div id="tooltip"></div>

    <script src="roman.js"></script>
    <script type="module" src="main.js"></script>
</body>
</html>
